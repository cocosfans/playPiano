{"version":3,"sources":["file:///D:/cocos/PlayPiano/assets/script/keys/key.ts"],"names":["_decorator","Component","AudioSource","Input","AudioClip","Vec3","CCInteger","Constant","ccclass","property","key","type","_curPos","_startMove","_curJumpTime","start","_audioSource","getComponent","node","on","EventType","TOUCH_START","onTouchStart","event","ClickId","keyId","play","position","setPosition","x","y","z","Hited","off","update","deltaTime"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAgBC,MAAAA,W,OAAAA,W;AAAYC,MAAAA,K,OAAAA,K;AAAMC,MAAAA,S,OAAAA,S;AAAUC,MAAAA,I,OAAAA,I;AAAuBC,MAAAA,S,OAAAA,S;;AAC/EC,MAAAA,Q,iBAAAA,Q;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBT,U;;qBAGjBU,G,WADZF,OAAO,CAAC,KAAD,C,UAEPC,QAAQ,CAACL,SAAD,C,UAERK,QAAQ,CAACP,WAAD,C,UAERO,QAAQ,CAAC;AAACE,QAAAA,IAAI,EAACL;AAAN,OAAD,C,2BANT,MACaI,GADb,SACyBT,SADzB,CACmC;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eAO3BW,OAP2B,GAOd,IAAIP,IAAJ,EAPc;AAAA,eAQ3BQ,UAR2B,GAQR,KARQ;AAAA,eAS3BC,YAT2B,GASJ,CATI;AAAA;;AAUnC;AACIC,QAAAA,KAAK,GAAG;AACP,eAAKC,YAAL,GAAkB,KAAKC,YAAL,CAAkBf,WAAlB,CAAlB;AACD,eAAKgB,IAAL,CAAUC,EAAV,CAAahB,KAAK,CAACiB,SAAN,CAAgBC,WAA7B,EAAyC,KAAKC,YAA9C,EAA2D,IAA3D;AACC;;AAEDA,QAAAA,YAAY,CAACC,KAAD,EACZ;AAAO;AAAA;AAAA,oCAASC,OAAT,GAAiB,KAAKC,KAAtB;;AACI,eAAKT,YAAL,CAAkBU,IAAlB;;AACP,eAAKd,OAAL,GAAa,KAAKM,IAAL,CAAUS,QAAvB;AACA,eAAKT,IAAL,CAAUU,WAAV,CAAsB,KAAKhB,OAAL,CAAaiB,CAAnC,EAAqC,KAAKjB,OAAL,CAAakB,CAAb,GAAe,EAApD,EAAuD,KAAKlB,OAAL,CAAamB,CAApE,EAHJ,CAG4E;;AACxE,eAAKlB,UAAL,GAAgB,IAAhB;AACA;AAAA;AAAA,oCAASmB,KAAT,GAAiB,CAAjB;AACA,eAAKd,IAAL,CAAUe,GAAV,CAAc9B,KAAK,CAACiB,SAAN,CAAgBC,WAA9B,EAA0C,KAAKC,YAA/C,EAA4D,IAA5D;AACH;;AACDY,QAAAA,MAAM,CAACC,SAAD,EAAoB;AACtB,cAAI,KAAKtB,UAAT,EAAqB;AACjB,iBAAKC,YAAL,IAAqBqB,SAArB,CADiB,CACe;;AAChC,gBAAI,KAAKrB,YAAL,GAAoB,GAAxB,EAA6B;AAAE;AAC3B;AACA,mBAAKI,IAAL,CAAUU,WAAV,CAAsB,KAAKhB,OAAL,CAAaiB,CAAnC,EAAqC,KAAKjB,OAAL,CAAakB,CAAb,GAAe,EAApD,EAAuD,KAAKlB,OAAL,CAAamB,CAApE,EAFyB,CAE+C;;AACxE,mBAAKlB,UAAL,GAAkB,KAAlB,CAHyB,CAGc;;AACvC,mBAAKC,YAAL,GAAkB,CAAlB;AACA,mBAAKI,IAAL,CAAUC,EAAV,CAAahB,KAAK,CAACiB,SAAN,CAAgBC,WAA7B,EAAyC,KAAKC,YAA9C,EAA2D,IAA3D;AACH;AAER;AACJ;;AArCkC,O;;;;;iBAEN,I;;;;;;;iBAEM,I;;;;;;;iBAEnB,C","sourcesContent":["import { _decorator, Component, Node,AudioSource,Input,AudioClip,Vec3,input,EventTouch, CCInteger} from 'cc';\r\nimport { Constant } from '../framework/Constant';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('key')\r\nexport class key extends Component {\r\n@property(AudioClip)\r\npublic _audioClip:AudioClip =null;\r\n@property(AudioSource)\r\npublic _audioSource: AudioSource = null!;\r\n@property({type:CCInteger})\r\nprivate keyId = 0; \r\nprivate _curPos:Vec3=new Vec3();\r\nprivate _startMove:boolean=false;\r\nprivate _curJumpTime: number = 0;\r\n//private _audioSource:AudioSource = null;\r\n    start() {\r\n     this._audioSource=this.getComponent(AudioSource);\r\n    this.node.on(Input.EventType.TOUCH_START,this.onTouchStart,this);\r\n    }\r\n  \r\n    onTouchStart(event:EventTouch)\r\n    {      Constant.ClickId=this.keyId;\r\n               this._audioSource.play();\r\n        this._curPos=this.node.position;\r\n        this.node.setPosition(this._curPos.x,this._curPos.y+20,this._curPos.z); // 将位移设置给角色\r\n        this._startMove=true;\r\n        Constant.Hited = 1;\r\n        this.node.off(Input.EventType.TOUCH_START,this.onTouchStart,this);\r\n    }\r\n    update(deltaTime: number) {\r\n        if (this._startMove) {\r\n            this._curJumpTime += deltaTime; // 累计总的跳跃时间\r\n            if (this._curJumpTime > 0.2) { // 当跳跃时间是否结束\r\n                // end \r\n                this.node.setPosition(this._curPos.x,this._curPos.y-20,this._curPos.z); // 强制位置到终点\r\n                this._startMove = false;               // 清理跳跃标记\r\n                this._curJumpTime=0;\r\n                this.node.on(Input.EventType.TOUCH_START,this.onTouchStart,this);\r\n            } \r\n        \r\n    }\r\n}\r\n}"]}