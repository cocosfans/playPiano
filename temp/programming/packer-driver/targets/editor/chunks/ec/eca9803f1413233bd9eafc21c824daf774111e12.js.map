{"version":3,"sources":["file:///D:/cocos/PlayPiano/assets/script/key.ts"],"names":["_decorator","Component","AudioSource","Input","AudioClip","Vec3","GameManager","ccclass","property","key","_curPos","_startMove","_curJumpTime","start","_audioSource","getComponent","node","on","EventType","TOUCH_START","onTouchStart","event","_gamemanager","getSong","play","position","setPosition","x","y","z","off","parseCSV","csvString","lines","split","result","forEach","line","items","push","update","deltaTime"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAgBC,MAAAA,W,OAAAA,W;AAAYC,MAAAA,K,OAAAA,K;AAAMC,MAAAA,S,OAAAA,S;AAAUC,MAAAA,I,OAAAA,I;;AACxDC,MAAAA,W,iBAAAA,W;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBR,U;;qBAGjBS,G,WADZF,OAAO,CAAC,KAAD,C,UAEPC,QAAQ,CAACJ,SAAD,C,UAERI,QAAQ,CAACN,WAAD,C,UAERM,QAAQ;AAAA;AAAA,qC,2BANT,MACaC,GADb,SACyBR,SADzB,CACmC;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eAO3BS,OAP2B,GAOd,IAAIL,IAAJ,EAPc;AAAA,eAQ3BM,UAR2B,GAQR,KARQ;AAAA,eAS3BC,YAT2B,GASJ,CATI;AAAA;;AAUnC;AACIC,QAAAA,KAAK,GAAG;AACP,eAAKC,YAAL,GAAkB,KAAKC,YAAL,CAAkBb,WAAlB,CAAlB;AACD,eAAKc,IAAL,CAAUC,EAAV,CAAad,KAAK,CAACe,SAAN,CAAgBC,WAA7B,EAAyC,KAAKC,YAA9C,EAA2D,IAA3D;AACC;;AAEDA,QAAAA,YAAY,CAACC,KAAD,EACZ;AACG,eAAKC,YAAL,GAAkB,KAAKP,YAAL;AAAA;AAAA,yCAAlB;;AACA,eAAKO,YAAL,CAAkBC,OAAlB,CAA0B,CAA1B,EAA4B,CAA5B;;AACQ,eAAKT,YAAL,CAAkBU,IAAlB;;AACP,eAAKd,OAAL,GAAa,KAAKM,IAAL,CAAUS,QAAvB;AACA,eAAKT,IAAL,CAAUU,WAAV,CAAsB,KAAKhB,OAAL,CAAaiB,CAAnC,EAAqC,KAAKjB,OAAL,CAAakB,CAAb,GAAe,EAApD,EAAuD,KAAKlB,OAAL,CAAamB,CAApE,EALJ,CAK4E;;AACxE,eAAKlB,UAAL,GAAgB,IAAhB;AACA,eAAKK,IAAL,CAAUc,GAAV,CAAc3B,KAAK,CAACe,SAAN,CAAgBC,WAA9B,EAA0C,KAAKC,YAA/C,EAA4D,IAA5D;AACH;;AACDW,QAAAA,QAAQ,CAACC,SAAD,EAAY;AAChB,cAAIC,KAAK,GAAGD,SAAS,CAACE,KAAV,CAAgB,IAAhB,CAAZ;AACA,cAAIC,MAAM,GAAG,EAAb;AACAF,UAAAA,KAAK,CAACG,OAAN,CAAeC,IAAD,IAAU;AACpB,gBAAIC,KAAK,GAAGD,IAAI,CAACH,KAAL,CAAW,IAAX,CAAZ;AACAC,YAAAA,MAAM,CAACI,IAAP,CAAYD,KAAZ;AACH,WAHD;AAIA,iBAAOH,MAAP;AACH;;AACDK,QAAAA,MAAM,CAACC,SAAD,EAAoB;AACtB,cAAI,KAAK9B,UAAT,EAAqB;AACjB,iBAAKC,YAAL,IAAqB6B,SAArB,CADiB,CACe;;AAChC,gBAAI,KAAK7B,YAAL,GAAoB,GAAxB,EAA6B;AAAE;AAC3B;AACA,mBAAKI,IAAL,CAAUU,WAAV,CAAsB,KAAKhB,OAAL,CAAaiB,CAAnC,EAAqC,KAAKjB,OAAL,CAAakB,CAAb,GAAe,EAApD,EAAuD,KAAKlB,OAAL,CAAamB,CAApE,EAFyB,CAE+C;;AACxE,mBAAKlB,UAAL,GAAkB,KAAlB,CAHyB,CAGc;;AACvC,mBAAKC,YAAL,GAAkB,CAAlB;AACA,mBAAKI,IAAL,CAAUC,EAAV,CAAad,KAAK,CAACe,SAAN,CAAgBC,WAA7B,EAAyC,KAAKC,YAA9C,EAA2D,IAA3D;AACH;AAER;AACJ;;AA/CkC,O;;;;;iBAEN,I;;;;;;;iBAEM,I;;;;;;;iBAEF,I","sourcesContent":["import { _decorator, Component, Node,AudioSource,Input,AudioClip,Vec3,input,EventTouch} from \"cc\";\r\nimport { GameManager } from './framework/GameManager';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('key')\r\nexport class key extends Component {\r\n@property(AudioClip)\r\npublic _audioClip:AudioClip =null;\r\n@property(AudioSource)\r\npublic _audioSource: AudioSource = null!;\r\n@property(GameManager)\r\nprivate _gamemanager:GameManager=null;\r\nprivate _curPos:Vec3=new Vec3();\r\nprivate _startMove:boolean=false;\r\nprivate _curJumpTime: number = 0;\r\n//private _audioSource:AudioSource = null;\r\n    start() {\r\n     this._audioSource=this.getComponent(AudioSource);\r\n    this.node.on(Input.EventType.TOUCH_START,this.onTouchStart,this);\r\n    }\r\n  \r\n    onTouchStart(event:EventTouch)\r\n    {   \r\n       this._gamemanager=this.getComponent(GameManager);\r\n       this._gamemanager.getSong(1,2);\r\n               this._audioSource.play();\r\n        this._curPos=this.node.position;\r\n        this.node.setPosition(this._curPos.x,this._curPos.y+20,this._curPos.z); // 将位移设置给角色\r\n        this._startMove=true;\r\n        this.node.off(Input.EventType.TOUCH_START,this.onTouchStart,this);\r\n    }\r\n    parseCSV(csvString) {\r\n        let lines = csvString.split('\\n');\r\n        let result = [];\r\n        lines.forEach((line) => {\r\n            let items = line.split('\\t');\r\n            result.push(items);\r\n        });\r\n        return result;\r\n    }\r\n    update(deltaTime: number) {\r\n        if (this._startMove) {\r\n            this._curJumpTime += deltaTime; // 累计总的跳跃时间\r\n            if (this._curJumpTime > 0.2) { // 当跳跃时间是否结束\r\n                // end \r\n                this.node.setPosition(this._curPos.x,this._curPos.y-20,this._curPos.z); // 强制位置到终点\r\n                this._startMove = false;               // 清理跳跃标记\r\n                this._curJumpTime=0;\r\n                this.node.on(Input.EventType.TOUCH_START,this.onTouchStart,this);\r\n            } \r\n        \r\n    }\r\n}\r\n}"]}